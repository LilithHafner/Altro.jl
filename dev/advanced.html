<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Options · Altro</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Altro</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li><a class="tocitem" href="quickstart.html">Getting Started</a></li><li><a class="tocitem" href="options.html">Solver Options</a></li><li class="is-active"><a class="tocitem" href="advanced.html">Advanced Options</a><ul class="internal"><li><a class="tocitem" href="#Infeasible-Start"><span>Infeasible Start</span></a></li><li><a class="tocitem" href="#Using-Implicit-Integrators"><span>Using Implicit Integrators</span></a></li><li><a class="tocitem" href="#Disabling-Octavian"><span>Disabling Octavian</span></a></li></ul></li><li><a class="tocitem" href="api.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="advanced.html">Advanced Options</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="advanced.html">Advanced Options</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RoboticExplorationLab/Altro.jl/blob/master/docs/src/advanced.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Advanced-Options"><a class="docs-heading-anchor" href="#Advanced-Options">Advanced Options</a><a id="Advanced-Options-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Options" title="Permalink"></a></h1><ul><li><a href="advanced.html#Advanced-Options">Advanced Options</a></li><li class="no-marker"><ul><li><a href="advanced.html#Infeasible-Start">Infeasible Start</a></li><li><a href="advanced.html#Using-Implicit-Integrators">Using Implicit Integrators</a></li><li><a href="advanced.html#Disabling-Octavian">Disabling Octavian</a></li></ul></li></ul><h2 id="Infeasible-Start"><a class="docs-heading-anchor" href="#Infeasible-Start">Infeasible Start</a><a id="Infeasible-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Infeasible-Start" title="Permalink"></a></h2><p>Standard indirect methods such as iLQR cannot be initialized with a state trajectory since they are always dynamically feasible. However, for some problems an initial  state trajectory is very informative and easy to generate, while supplying an  initial guess for the controls is extremely difficult. For example, consider a  quadrotor flying around some obstacles. Guessing a good path, or even the velocities, would be pretty easy, but supplying the control sequence to generate that path  is nearly as hard as just solving the entire trajectory optimization problem. </p><p>ALTRO allows for &quot;infeasible&quot; starts by augmenting the discrete dynamics so that  they become fully actuated, i.e. for any state we can provide a control that will acheive it. This increases the size of the control dimension by <code>n</code>, the number of states in the original problem, so the problem becomes more expensive to solve.</p><p>We specify that we want an infeasible start by passing the <code>infeasible</code> flag to  the ALTRO constructor:</p><pre><code class="language-julia hljs">using Altro
prob,opts = Problems.DubinsCar(:escape)
solver = ALTROSolver(prob, opts, infeasible=true, R_inf=0.1)</code></pre><p>where <code>R_inf</code> is the norm of the regularizer on the additional controls. Notice how the new control dimension is 5, since the original control and state dimensions were 2 and 3.</p><p>The initial state trajectory can be provided using one of</p><pre><code class="language-julia hljs">initial_states!(solver, X0)
initial_trajectory!(solver, Z0)</code></pre><p>where <code>X0::Union{SVector, Matrix, Vector{&lt;:StaticVector}}</code> and  <code>Z0::SampledTrajectory</code>. </p><article class="docstring"><header><a class="docstring-binding" id="Altro.InfeasibleModel" href="#Altro.InfeasibleModel"><code>Altro.InfeasibleModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">InfeasibleModel</code></pre><p>An infeasible model is an augmented dynamics model that makes the system artifically fully actuated by augmenting the control vector with <code>n</code> additional controls. The dynamics are handled explicitly in discrete time:</p><p><span>$x_{k+1} = f(x_k,u_k,dt) + w_k$</span></p><p>where <span>$w_k$</span> are the additional <code>n</code>-dimensional controls. In practice, these are constrained to be zero by the end of the solve.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">InfeasibleModel(model::AbstractModel)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RoboticExplorationLab/Altro.jl/blob/31bc8c65a477dac25dbaafbedbf0f20eea0da8ec/src/infeasible_model.jl#L58-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Altro.InfeasibleConstraint" href="#Altro.InfeasibleConstraint"><code>Altro.InfeasibleConstraint</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">InfeasibleConstraint</code></pre><p>Constraints additional <span>$infeasible&#39;&#39; controls to be zero. Constructors:$</span><code>julia InfeasibleConstraint(model::InfeasibleModel) InfeasibleConstraint(n,m)</code>``</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RoboticExplorationLab/Altro.jl/blob/31bc8c65a477dac25dbaafbedbf0f20eea0da8ec/src/infeasible_model.jl#L169-L177">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Altro.infeasible_trajectory" href="#Altro.infeasible_trajectory"><code>Altro.infeasible_trajectory</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Calculate a dynamically feasible initial trajectory for an infeasible problem, given a desired trajectory</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RoboticExplorationLab/Altro.jl/blob/31bc8c65a477dac25dbaafbedbf0f20eea0da8ec/src/infeasible_model.jl#L138-L140">source</a></section></article><h2 id="Using-Implicit-Integrators"><a class="docs-heading-anchor" href="#Using-Implicit-Integrators">Using Implicit Integrators</a><a id="Using-Implicit-Integrators-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Implicit-Integrators" title="Permalink"></a></h2><p>By leveraging the functionality of RobotDynamics.jl, Altro can easily solve problems  using implicit integrators like implicit midpoint, which as a symplectic integrator  has energy-conserving behaviors and also preserves any implicit norms in the dynamics (such as the norm on a quaternion representing rotations). The following example  shows how to use an implicit integrator:</p><pre><code class="language-julia hljs">using RobotZoo: Cartpole
using RobotDynamics
using TrajectoryOptimization
using Altro
using LinearAlgebra
const RD = RobotDynamics

model = Cartpole()
dmodel = RD.DiscretizedDynamics{RD.ImplicitMidpoint}(model)

# Temporary &quot;hack&quot; to make sure it doesn&#39;t try to use the `UserDefined` method
RD.default_diffmethod(::Cartpole) = RD.ForwardAD()

tf = 2.0
N = 51
n,m = RD.dims(model)
x0 = [0,0,0,0.]
xf = [0,pi,0,0]

Q = Diagonal(fill(1.0, n))
R = Diagonal(fill(0.1, m))
Qf = Q*(N-1)
obj = LQRObjective(Q,R,Qf,xf,N)

prob = Problem(dmodel, obj, x0, tf)

solver = ALTROSolver(
    prob,
    dynamics_diffmethod=RD.ImplicitFunctionTheorem(RD.ForwardAD())
)</code></pre><p>The key here is to specify the solver option <code>dynamics_diffmethod</code> to be <code>RobotDynamics.ImplicitFunctionTheorem()</code> which takes another <code>RobotDynamics.DiffMethod</code> as an argument, which specified how the Jacobians of the dynamics residual should be  computed. The implicit function theorem then uses the partial derivatives to compute  the Jacobians with respect to the next state, which are the Jacobians requried by  algorithms like iLQR.</p><h2 id="Disabling-Octavian"><a class="docs-heading-anchor" href="#Disabling-Octavian">Disabling Octavian</a><a id="Disabling-Octavian-1"></a><a class="docs-heading-anchor-permalink" href="#Disabling-Octavian" title="Permalink"></a></h2><p>By default, Altro.jl uses  <a href="https://github.com/JuliaLinearAlgebra/Octavian.jl">Octavian.jl</a> for matrix  multiplication. This typically yields very good runtime performance but can take a  while to compile the first time. If you want to disable the use of Octavian,  set the environment variable <code>ALTRO_USE_OCTAVIAN = false</code> prior to using Altro. If Altro has already precompiled, you&#39;ll need to delete the compiled cache using</p><pre><code class="nohighlight hljs">rm -rf ~/.julia/compiled/v1.x/Altro/*</code></pre><p>and then when you enter <code>using Altro</code> in the Julia REPL you should see it print a  message that it&#39;s precompiling. You can check to see if Altro is using Octavian  by checking the <code>Altro.USE_OCTAVIAN</code> variable in the Altro module.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="options.html">« Solver Options</a><a class="docs-footer-nextpage" href="api.html">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Monday 11 April 2022 11:50">Monday 11 April 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
